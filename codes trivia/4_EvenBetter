import { useState, useEffect } from 'react';
import './App.css';


const App = () => {

  const [questions, setQuestions] = useState()
  const [message, setMessage] = useState()
  const [color, setColor] = useState()
  const [wrightAnswer, setWrightAnswer] = useState()
  
    const answerSubmit = (e) => {

    e.preventDefault()

    setTimeout(newQ, 4000)

    function newQ() {
    
	 fetch("https://the-trivia-api.com/api/questions?limit=50")
        .then(res => res.json())
        .then(data => setQuestions((data[Math.floor(Math.random() * 50)])))
      setMessage("")
      setColor("")
      setWrightAnswer("")
    }

    if (e.target.value === questions.correctAnswer) {
      setMessage("WRIGHT ANSWER !!!")
      setWrightAnswer("")
      setColor("green")
    } else {
      setMessage("WRONG ANSWER !!!")
      setColor("red")
     e.target.value !== questions.correctAnswer &&setWrightAnswer(questions.correctAnswer)}
    // questions &&
    // console.log(questions.incorrectAnswers.indexOf(questions.correctAnswer));
    // console.log(questions.correctAnswer);
  }
  useEffect(() => {
    function randomArrayShuffle(array) {
      var currentIndex = array.length, temporaryValue, randomIndex;
      while (0 !== currentIndex) {
        randomIndex = Math.floor(Math.random() * currentIndex);
        currentIndex -= 1;
        temporaryValue = array[currentIndex];
        array[currentIndex] = array[randomIndex];
        array[randomIndex] = temporaryValue;
      }
      return array;
    }
    questions &&
      randomArrayShuffle(questions.incorrectAnswers)

 }, [])
 
   questions && questions.incorrectAnswers.length <= 3 &&
    questions.incorrectAnswers.push(questions.correctAnswer)
    
    return (

    <main>
      <h1>Questions</h1>
      <aside>
        {questions &&
          <h2> CATEGORY:
            {" " + questions.category}</h2>
        }<br />

        {questions &&
          <div className="question"> {questions.question}</div>
        }
        <br />
        {questions &&
          <button style={{ backgroundColor: `${color}` }} id={questions.id} value={questions.incorrectAnswers[0]} onClick={(e) => answerSubmit(e)}>{questions.incorrectAnswers[0]}</button>
        }

        {questions &&
          <button style={{ backgroundColor: `${color}` }} id={questions.id} value={questions.incorrectAnswers[1]} onClick={(e) => answerSubmit(e)}> {questions.incorrectAnswers[1]}</button>
        }

        {questions &&
          <button style={{ backgroundColor: `${color}` }} id={questions.id} value={questions.incorrectAnswers[2]} onClick={(e) => answerSubmit(e)}> {questions.incorrectAnswers[2]}</button>
        }

        {questions &&
          <button style={{ backgroundColor: `${color}` }} id={questions.id} value={questions.incorrectAnswers[3]} onClick={(e) => answerSubmit(e)}> {questions.incorrectAnswers[3]}</button>
        }
        {!questions && <button onClick={answerSubmit}>START GAME</button>}

        <br />
        <br />

        <p style={{ color: `${color}` }}>{message} </p>

        <p>{wrightAnswer !== "" && questions && "Wright Answer : " + wrightAnswer}</p>

      </aside>

    </main>
  );
}

export default App;

    
    

